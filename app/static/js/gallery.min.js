$(function () { var e, i, t, s = $("#header"), n = $("#frame"), a = $("#slider"), l = $("#themes"), r = $("#nav"), c = n.find(".photo"), d = n.children(".photo-caption"), o = a.children("#thumbnails"), h = a.children("span"), p = 0; function m(e) { if (e > 0 && e <= photos.length) { var i = photos[e - 1]; c.attr("src", "/static/" + i.url), c.addClass("photos w3-border w3-padding"), d.children(".title").text(i.title), d.children(".data").text("Taken on " + i.date + " in " + i.location) } } function f(e) { i && i.removeClass("selected"), (i = $(e)).addClass("selected") } function u() { o.children().each(function () { p += $(this).outerWidth(!0) }), e = o.children(":first"), v(), b("prev", !1) } function v() { slider_width = a.innerWidth(), slider_width < p && "none" == h.css("display") ? h.css("display", "block") : slider_width >= p && "block" == h.css("display") && h.css("display", "none") } function b(e, i) { $btn = a.children("." + e), i ? $btn.removeClass("disable") : $btn.addClass("disable") } function g() { return o.children(":last").position().top } $.getJSON("/gallery_json", function (e) { e = JSON.parse(e), s.children(".album").text(e.album.name), images = e.images, thumbnails = ""; for (var i = 0; i < e.images.length; i++)images = e.images[i], thumbnails += "<li><img data-index=" + images.id + " src='/static/" + images.thumb_url + "' alt='" + images.title + "' title='" + images.title + "' /></li>"; o.html(thumbnails), m(t = parseInt(photos[0].id, 10)), firstThumbnail = o.children(":first"), f(firstThumbnail); var n = firstThumbnail.children("img"); n[0].complete ? u() : n.load(u), $("body").css("opacity", "1") }), o.on("click", "img", function (e) { $this = $(this); var i = parseInt($this.data("index"), 10); m(i), f($this.parent("li")), t = i }), r.on("click", "button", function (e) { var s = this.className; s.indexOf("prev") >= 0 && t > 1 ? (t-- , i.removeClass("selected"), (i = i.prev()).addClass("selected")) : s.indexOf("next") >= 0 && t < photos.length && (t++ , i.removeClass("selected"), (i = i.next()).addClass("selected")), m(t) }), $(window).on("resize", function () { v(), o.children().css("display", "inline-block"), e = o.children(":first"), b("prev", !1), b("next", !0) }), a.on("click", "span", function (i) { var t = i.target.className, s = o.children(":first"), n = g(); t.indexOf("prev") >= 0 && "none" == s.css("display") ? ($prev = e.prev(), $prev.length > 0 && (e = $prev), e.css("display", "inline-block"), s[0] === e[0] && b("prev", !1), b("next", !0)) : t.indexOf("next") >= 0 && n > 0 && (e.css("display", "none"), e = e.next(), b("prev", !0), 0 === g() && b("next", !1)) }), l.on("click", "span", function (e) { $this = $(this), theme = $this.data("theme"), $this.hasClass("active") || ("another" == theme ? ($('link[href="/static/css/original.min.css"]').attr({ href: "/static/css/another.min.css" }), r.appendTo("#frame"), d.appendTo(".photo-wrapper")) : ($('link[href="/static/css/another.min.css"]').attr({ href: "/static/css/original.min.css" }), r.appendTo("#header"), d.appendTo("#frame")), l.children(".active").removeClass("active"), $this.addClass("active")) }) });